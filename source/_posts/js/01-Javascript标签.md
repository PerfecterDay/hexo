---
title: HTML中的 Javascript
date: 2019-01-02 21:14:27
tags: js
category: js
---

Js最常用的就是 Javascript 标签，然而许多 web开发者并不全都知道下面这些知识。


## Javascript 标签的6个属性
1. async: 可选，只对外部文件有效，表示应该立即下载脚本，但不应该妨碍页面的其他操作，比如下载其他资源或等待加载其它脚本。
2. defer: 可选，只对外部脚本文件有效。表示脚本可以延迟到文档完全被解析和显示之后再执行。
3. src: 可选，表示包含要执行的外部脚本文件。
4. charset: 可选，指示字符集。
5. language: 已废弃。
6. type: 一般为 text/javascript。

## 两种解析 Javascript 的标签的方式
1. 内嵌 Javascript : 代码会从上到下依此解释，在解释器对 `<script>` 元素内部的所有代码求值完毕之前，页面中的其余内容都不会被浏览器加载或显示。以下代码，页面上不会显示test.
```
    <!DOCTYPE html>
    <html>
    <head>
        <script>
            while(true){}
        </script>
    </head>
    <body>
        test
    </body>
    </html>
```

2. 外部 Javascript :如果通过 `<script>` 元素来包含外部脚本文件，那么 src 属性是必须的。与解析内嵌的 Javascript 代码一样，在解析外部 Javascript 文件（包括下载该文件）时，页面也会暂时停止。也就是说把上面代码中的 while 死循环放到外部文件，并通过 `<script>` 元素引入时，html 也不会显示。而且，如果下载 Javascript 文件出现问题，也会阻断页面显示。
3. 如果是引入外部 Javascript ，即带有 src 属性的 `<script>` 标签，则在起始标签中间不应该在包含额外的 JS 代码，否则，嵌入的代码不会执行而是会被直接忽略。
4. 只要不存在 defer 和 async 属性，浏览器都会按照 `<script>` 元素在页面中的出现的顺序对它们依次进行解析。就是说第一个解析执行之后才会解析第二个，以此类推。

## script 标签的位置
传统的网页一般将 script 元素放在 head 元素中，这意味着必须等到全部的 Javascript 代码都被下载、解析和执行完之后，才能开始呈现页面的内容（浏览器遇到 `<body>` 标签时才开始呈现内容）。这对于那些需要很多 Javascript 代码的页面来说，会导致浏览器在呈现页面时出现明显的延迟，延迟期间，页面将是一片空白。用户体验时很差的。

所以，现代Web应用程序一般把 JavaScript 引用放在 `<body>` 元素中页面内容的后面。

## 延迟脚本
含有 defer 属性的脚本就是延迟脚本。 defer 属性只能用在外部脚本文件。延迟脚本会被立即下载，但脚本会被延迟到整个页面都解析完毕之后再运行。

HTML5 规范要求脚本按照它们的出现的先后顺序执行，因此第一个延迟脚本会先于第二个延迟脚本执行，而两个脚本会先于 DOMContentLoaded 事件执行。

但是在现实中，延迟脚本并不一定会按照顺序执行，也不一定会在 DOMContentLoaded 事件出发前执行，因此最好只包含一个延迟脚本。

## 异步脚本
含有 async 属性的脚本时异步脚本，异步脚本会立即下载，但异步脚本并不保证按照指定它们的先后顺序执行。指定 async 属性的目的时不让页面等待脚本下载和执行，从而异步加载页面其他内容。为此，异步脚本不要在加载期间修改DOM。

异步脚步一定会在页面 load 事件前执行，但可能会在 DOMContentLoaded 事件触发之前或之后执行。

## 嵌入脚本 VS 外部文件
外部文件一般有以下有点：
1. 可维护性：把 Javascript 代码放到外部文件并集中放到一个文件夹，比遍及在各个 HTML 页面维护起来轻松很多。
2. 可缓存：浏览器能够根据具体设置缓存链接的所有外部 Javascript 文件。如果多个页面引用同一个 Javascript 文件，那么这个文件只要下载一次。
3. 适应未来：外部脚本文件在 XHTML 和 HTML 中的语法是相同的。

## noscript
noscript 元素可以包含出现在文档 body 元素中的任何 HTML 元素—— script元素除外。但是只有在下面情况下才会显示出来：
+ 浏览器不支持 Javascript 脚本
+ 浏览器支持 Javascript 脚本，但被禁用。