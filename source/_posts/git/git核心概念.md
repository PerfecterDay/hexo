---
title: git 核心概念
date: 2020-05-15 13:28:10
tags: git
category: git
---

Git 更像是把数据看作是对小型文件系统的一系列快照。 在 Git 中，每当你提交更新或保存项目状态时，它基本上就会对当时的全部文件创建一个快照并保存这个快照的索引。 为了效率，如果文件没有修改，Git 不再重新存储该文件，而是只保留一个链接指向之前存储的文件。 Git 对待 数据更像是一个快照流。
<img src="/pics/git-snapshot.png" alt="">
Git 一次提交大概的数据结构如下图所示：
<img src="/pics/git-commit.png" alt="">

Git 拥有三个阶段：工作区、暂存区（索引）及 Git 目录。
+ 工作区：工作区是对项目的某个版本独立提取出来的内容。 这些从 Git 仓库的压缩数据库中提取出来的文件，放在磁盘上
供你使用或修改。就是相当于从版本库中提取出一个快照到磁盘上以作修改
+ 暂存区是一个文件，保存了下次将要提交的文件列表信息，一般在 Git 仓库目录中。
+ Git 仓库目录是 Git 用来保存项目的元数据和对象数据库的地方。 这是 Git 中最重要的部分，从其它计算机克隆
仓库时，复制的就是这里的数据。


## 重置与检出
Git 的三个工作区间可以想像成三棵树， reset 命令会以特定的顺序重写这三棵树，在你指定以下选项时停止:
1. 移动 HEAD 分支的指向 (若指定了 --soft，则到此停止) 
2. 使索引看起来像 HEAD (若未指定 --hard，则到此停止) 
3. 使工作目录看起来像索引
<img src="/pics/git-reset.png" alt="">

git reset 后边加上文件或目录路径时，reset 将会跳过第一步，并且将它的作用范围限定为指定的文件或文件集合。  
`git reset eb43bf file.txt`: 将提交为 eb43bf 中的 file.txt 文件版本恢复到索引



下面的速查表列出了命令对树的影响。 “HEAD” 一列中的 “REF” 表示该命令移动了 HEAD 指向的分支引 用，而 “HEAD” 则表示只移动了 HEAD 自身。 特别注意 WD Safe? 一列——如果它标记为 NO，那么运行该命 令之前请考虑一下。
<img src="/pics/git-reset-checkout.png" alt="">